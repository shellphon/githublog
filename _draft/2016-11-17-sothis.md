---
layout: post
title:  this妙用
category: Hello Code
keywords: this, javascript
description: 
---

关于`this`, 现在应该有很多文章提到了它，它在JavaScript里的作用特别明显，几乎一写到js，基本会用到`this`了，尤其是面向对象的时候。

在我看来，`this`往往和原型链、作用域扯上关系，又有所区别。

比方说作用域下访问变量这回事：
{%highlight javascript%}
var a = 1;
function b(){
  var a = 2;
  console.log(a);// 2
}
b();
console.log(a);//1
{%endhighlight%}

这段很简单的代码透露着作用域的信息，在JavaScript里，并没有块作用域这个概念，有别于java等语言（当然es6开始就有了）。

上面代码里如果function的`var a = 2;`注释掉，那么里面访问a变量会是这么一个顺序，先看一下function里面有没有声明变量a，有就拿来，没有，那就往上一层看是否有a，没有就继续往上，直到到了global， 浏览器下是window，示例代码就两层，所以会发现`a=1`，这就是作用域的一个访问过程。

但是，对于`this`,就不能这么搞了，应该有两个属性要特别注意，即 `this`和`arguments`,后者表示function的参数对象（类数组，但具有一些其他方法）；

`this`的概念可以参考 [MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/this)

文章里描述的this有很多情况，但在实际应用中，其实我觉得可以理解为一种情况，即当你使用this的时候，你只要知道这个this是哪个对象调用它的，那它就代表哪个对象了~

{%highlight javascript%}
var a = 1;
console.log(this.a);//1
function b(){
  console.log(this.a);
}
b();// 1
var c = {
  a:2
};
b.call(c);//2
b.bind(c)();//2
{%endhighlight%}

上述例子，一般而言，但找不到代码的调用对象是谁时，一般是最上层，即浏览器的window，or node下的global(后者我不熟)

一般来在浏览器下，直接`var a = 1;`其实可以当做是`window.a = 1;`,而在window下访问this，当然就是window了,所以第一个输出是1；

而我们知道，一般的function，其实它是`window.b`,自然里面的this指向的是window了。

`call`跟`apply`方法不同，他俩是的function能够绑定到某个对象上去使用，相当于这个对象拥有了这个方法，并且调用执行了。那么此时function里面的this就是指向绑定的对象咯，也就是示例里的`c`.

`es5`还有个`bind`方法，可以将function绑定到某个对象上作为一个新方法，差不多`jquery的proxy方法一样`，生成一个新的方法（带绑定对象的），此时新方法里的this就指向了bind的那个对象了。


